import{Bb as a,Cb as l,J as c,ha as o}from"./chunk-VSPMBJVT.js";var d=(()=>{class r{CART_STORAGE_KEY="shopping_cart";TAX_RATE=.1;SHIPPING_COST=15;cartItemsSignal=o(this.loadCartFromStorage());cartItems=this.cartItemsSignal.asReadonly();items=this.cartItemsSignal.asReadonly();itemCount=a(()=>this.cartItemsSignal().reduce((t,s)=>t+s.quantity,0));subtotal=a(()=>this.cartItemsSignal().reduce((t,s)=>{let e=s.product.discountPrice||s.product.price;return t+e*s.quantity},0));tax=a(()=>this.subtotal()*this.TAX_RATE);shipping=a(()=>this.cartItemsSignal().length>0?this.SHIPPING_COST:0);total=a(()=>this.subtotal()+this.tax()+this.shipping());cart=a(()=>({items:this.cartItemsSignal(),subtotal:this.subtotal(),tax:this.tax(),shipping:this.shipping(),total:this.total()}));constructor(){l(()=>{let t=this.cartItemsSignal();localStorage.setItem(this.CART_STORAGE_KEY,JSON.stringify(t))})}addToCart(t,s=1){let e=this.cartItemsSignal(),n=e.findIndex(i=>i.product.id===t.id);if(n>-1){let i=[...e];i[n].quantity+=s,this.cartItemsSignal.set(i)}else this.cartItemsSignal.set([...e,{product:t,quantity:s}])}removeFromCart(t){let s=this.cartItemsSignal().filter(e=>e.product.id!==t);this.cartItemsSignal.set(s)}updateQuantity(t,s){if(s<=0){this.removeFromCart(t);return}let e=this.cartItemsSignal(),n=e.findIndex(i=>i.product.id===t);if(n>-1){let i=[...e];i[n].quantity=s,this.cartItemsSignal.set(i)}}clearCart(){this.cartItemsSignal.set([])}loadCartFromStorage(){let t=localStorage.getItem(this.CART_STORAGE_KEY);return t?JSON.parse(t):[]}static \u0275fac=function(s){return new(s||r)};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();export{d as a};
