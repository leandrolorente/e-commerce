<app-header></app-header>

<main class="main-content">
  <div class="container">
    <!-- Hero Section -->
    <div class="hero-banner">
      <h1>Ofertas Imperd√≠veis üî•</h1>
      <p>Descontos de at√© 50% em produtos selecionados</p>
    </div>
    
    @if (loading) {
      <div class="loading">
        <div class="spinner"></div>
        <p>Carregando produtos incr√≠veis...</p>
      </div>
    } @else {
      @if (products.length > 0) {
        <div class="products-grid">
          @for (product of products; track product.id) {
            <div class="product-card" [class.added]="addedToCart.has(product.id)">
              <!-- Badge de Desconto -->
              @if (product.discountPrice) {
                <div class="discount-badge">
                  -{{ getDiscountPercentage(product) }}%
                </div>
              }
              
              <!-- Carrossel de Imagens do Produto -->
              <div class="product-image-wrapper">
                <div class="carousel-container">
                  <button 
                    class="carousel-btn prev" 
                    (click)="prevImage(product.id, $event)"
                    *ngIf="product.images.length > 1"
                  >‚Äπ</button>
                  
                  <a [routerLink]="['/products', product.id]">
                    <img 
                      [src]="product.images[getCurrentImageIndex(product.id)]" 
                      [alt]="product.name" 
                      class="product-image"
                    >
                  </a>
                  
                  <button 
                    class="carousel-btn next" 
                    (click)="nextImage(product.id, $event)"
                    *ngIf="product.images.length > 1"
                  >‚Ä∫</button>
                </div>
                
                <!-- Indicadores de imagem -->
                @if (product.images.length > 1) {
                  <div class="image-indicators">
                    @for (img of product.images; track $index) {
                      <span 
                        class="indicator" 
                        [class.active]="getCurrentImageIndex(product.id) === $index"
                        (click)="setImageIndex(product.id, $index, $event)"
                      ></span>
                    }
                  </div>
                }
              </div>
              
              <!-- Informa√ß√µes -->
              <div class="product-info">
                <span class="product-category">{{ product.category }}</span>
                <a [routerLink]="['/products', product.id]" class="product-title-link">
                  <h3 class="product-title">{{ product.name }}</h3>
                </a>
                <p class="product-description">{{ product.description }}</p>
                
                <!-- Rating -->
                <div class="product-rating">
                  <span class="stars">‚≠ê {{ product.rating }}</span>
                  <span class="reviews">({{ product.reviewCount }} avalia√ß√µes)</span>
                </div>
                
                <!-- Pre√ßo e A√ß√£o -->
                <div class="product-footer">
                  <div class="price-container">
                    @if (product.discountPrice) {
                      <span class="original-price">R$ {{ product.price.toFixed(2) }}</span>
                      <span class="current-price discount">R$ {{ product.discountPrice.toFixed(2) }}</span>
                    } @else {
                      <span class="current-price">R$ {{ product.price.toFixed(2) }}</span>
                    }
                  </div>
                  
                  <button 
                    (click)="addToCart(product, $event)" 
                    class="btn-add-cart"
                    [class.added]="addedToCart.has(product.id)"
                  >
                    @if (addedToCart.has(product.id)) {
                      <span>‚úì Adicionado</span>
                    } @else {
                      <span>üõí Adicionar</span>
                    }
                  </button>
                </div>
                
                <!-- Estoque -->
                @if (product.stock < 10) {
                  <div class="stock-warning">
                    ‚ö†Ô∏è Apenas {{ product.stock }} em estoque!
                  </div>
                }
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="empty-state">
          <div class="empty-icon">üì¶</div>
          <h2>Nenhum produto encontrado</h2>
          <p>Tente ajustar seus filtros ou volte mais tarde</p>
        </div>
      }
    }
  </div>
</main>

<app-footer></app-footer>
