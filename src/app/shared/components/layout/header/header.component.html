<header class="header">
  <div class="container header-content">
    <!-- Logo -->
    <a routerLink="/" class="logo">
      <div class="logo-icon">üõçÔ∏è</div>
      <div class="logo-text">
        <h1>GuaranaTattoShop</h1>
        <span class="logo-subtitle">Est√∫dio Guarana Tatto</span>
      </div>
    </a>

    <!-- Search Bar -->
    <div class="search-container">
      <form (submit)="onSearch(); $event.preventDefault()" class="search-form">
        <span class="search-icon-left">üîç</span>
        <input 
          type="text" 
          name="searchTerm"
          [(ngModel)]="searchTerm"
          (input)="onSearchInput()"
          (blur)="closeSearchDropdown()"
          placeholder="O que voc√™ est√° procurando?"
          class="search-input"
          autocomplete="off"
        >
        <button type="submit" class="search-btn">Buscar</button>
      </form>

      @if (showSearchDropdown()) {
        <div class="search-dropdown">
          <div class="search-dropdown-header">
            <span>Sugest√µes</span>
          </div>
          <div class="search-suggestions">
            @for (product of searchSuggestions(); track product.id) {
              <div 
                class="suggestion-item"
                (mousedown)="selectSuggestion(product)"
              >
                <img [src]="product.images[0]" [alt]="product.name" class="suggestion-image">
                <div class="suggestion-details">
                  <h4 class="suggestion-name">{{ product.name }}</h4>
                  <p class="suggestion-category">{{ product.category }}</p>
                  <p class="suggestion-price">
                    @if (product.discountPrice) {
                      <span class="discount">{{ product.discountPrice | currency: 'BRL' }}</span>
                      <span class="original">{{ product.price | currency: 'BRL' }}</span>
                    } @else {
                      <span class="price">{{ product.price | currency: 'BRL' }}</span>
                    }
                  </p>
                </div>
              </div>
            }
          </div>
        </div>
      }
    </div>

    <!-- Navigation -->
    <nav class="nav">
      <a routerLink="/tattoos/body-map" class="nav-link">üìç √Åreas do Corpo</a>
      
      @if (isAuthenticated()) {
        <div class="user-menu">
          <span class="user-name">Ol√°, {{ currentUser()?.name }}</span>
          
          @if (isAdmin()) {
            <a routerLink="/admin" class="nav-link">Admin</a>
          }
          
          <div class="cart-container">
            <button 
              (click)="toggleCartDropdown()" 
              class="nav-link cart-link"
              type="button"
            >
              <i class="cart-icon">üõí</i>
              @if (cartItemCount() > 0) {
                <span class="cart-badge">{{ cartItemCount() }}</span>
              }
            </button>

            @if (showCartDropdown()) {
              <div class="cart-dropdown">
                <div class="cart-dropdown-header">
                  <h3>Meu Carrinho</h3>
                  <button (click)="closeCartDropdown()" class="close-btn">‚úï</button>
                </div>

                @if (cartItems().length === 0) {
                  <div class="empty-cart">
                    <i class="empty-icon">üõí</i>
                    <p>Seu carrinho est√° vazio</p>
                  </div>
                } @else {
                  <div class="cart-items">
                    @for (item of cartItems(); track item.product.id) {
                      <div class="cart-item">
                        <img [src]="item.product.images[0]" [alt]="item.product.name" class="item-image">
                        <div class="item-details">
                          <h4 class="item-name">{{ item.product.name }}</h4>
                          <p class="item-quantity">Qtd: {{ item.quantity }}</p>
                          <p class="item-price">{{ item.product.price * item.quantity | currency: 'BRL' }}</p>
                        </div>
                        <button 
                          (click)="removeFromCart(item.product.id)" 
                          class="remove-btn"
                          title="Remover"
                        >
                          üóëÔ∏è
                        </button>
                      </div>
                    }
                  </div>

                  <div class="cart-dropdown-footer">
                    <div class="total">
                      <span>Total:</span>
                      <strong>{{ cartTotal() | currency: 'BRL' }}</strong>
                    </div>
                    <button (click)="goToCart()" class="btn btn-primary btn-block">
                      Ver Carrinho Completo
                    </button>
                  </div>
                }
              </div>
            }
          </div>
          
          <button (click)="onLogout()" class="btn btn-outline">Sair</button>
        </div>
      } @else {
        <div class="auth-links">
          <a routerLink="/auth/login" class="btn btn-outline">Entrar</a>
          <a routerLink="/auth/register" class="btn btn-primary">Cadastrar</a>
        </div>
      }
    </nav>
  </div>
</header>
